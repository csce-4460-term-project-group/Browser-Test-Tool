<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" style="height:100%;">

<head>
    <meta charset="utf-8" />
    <title>Browser Test Tool</title>
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
    <link href="/Browser-Test-Tool/styles/all.css" rel="stylesheet" type="text/css" />
    <link href="/Browser-Test-Tool/styles/tab.css" rel="stylesheet" type="text/css" />
    <link href="/Browser-Test-Tool/styles/test-results.css" rel="stylesheet" type="text/css" />
</head>

<body>
    <h1>Browser Test Tool</h1>
    <button onclick="runTests(this)">Run Tests</button>
    <div>
        <button class="tab-html" id="tab-html-button" onclick="changeTab1()">HTML</button>
        <button class="tab-css" id="tab-css-button" onclick="changeTab2()">CSS</button>
    </div>
    <div class="tab-html-content" id="tab-html-content">
    </div>
    <div class="tab-css-content" id="tab-css-content">
    </div>
    <!--test sources-->
    <script src="/Browser-Test-Tool/tests/TestPrototype.js"></script>
    <script src="/Browser-Test-Tool/tests/TestHTML5Elements.js"></script>
    <script src="/Browser-Test-Tool/tests/TestHTML5GlobalAttributes.js"></script>
    <!--functions-->
    <script>
        function changeTab1() {
            document.getElementById("tab-html-content").style.display = "block";
            document.getElementById("tab-css-content").style.display = "none";
        }
        function changeTab2() {
            document.getElementById("tab-html-content").style.display = "none";
            document.getElementById("tab-css-content").style.display = "block";
        }
        function runTests(buttonClicked) {
            buttonClicked.disabled = true;
            var tests = [];
            tests.push(TestHTML5Elements());
            tests.push(TestHTML5GlobalAttributes());
            for (var i = 0; i < tests.length; i++) {
                var testsPassed = 0;
                for (var j = 0; j < tests[i].results.length; j++)
                    if (tests[i].results[j])
                        testsPassed++;
                var div1 = document.createElement("div");
                div1.classList.toggle("test-results");
                var button = document.createElement("button");
                var title = document.createElement("span");
                title.style.cssFloat = "left";
                title.textContent = tests[i].title;
                var score = document.createElement("span");
                score.style.cssFloat = "right";
                score.textContent = testsPassed + "/" + tests[i].results.length;
                var div2 = document.createElement("div");
                div2.style.display = "none";
                var div3 = document.createElement("div");
                div3.style.width = "100%";
                div3.style.backgroundColor = "#3996D2";
                div3.style.color = "#FFFFFF";
                var testDescriptionTemplate = document.createElement("span");
                testDescriptionTemplate.style.paddingLeft = "8pt";
                var testResultTemplate = document.createElement("span");
                testResultTemplate.style.cssFloat = "right";
                testResultTemplate.style.paddingRight = "8pt";
                for (var j = 0; j < tests[i].results.length; j++) {
                    var test = div3.cloneNode();
                    var testDescription = testDescriptionTemplate.cloneNode();
                    var testResult = testResultTemplate.cloneNode();
                    if (!tests[i].results[j])
                        test.style.backgroundColor = "#D34F4F";
                    testDescription.textContent = tests[i].testDescriptions[j];
                    testResult.textContent = tests[i].results[j];
                    test.appendChild(testDescription);
                    test.appendChild(testResult);
                    div2.appendChild(test);
                }
                button.appendChild(title);
                button.appendChild(score);
                button.div = div2;
                button.onclick = function () { expandOrCollapseTestResults(this.div); };
                div1.appendChild(button);
                div1.appendChild(div2);
                document.getElementById("tab-html-content").appendChild(div1);
            }
            document.getElementById("tab-html-button").style.display = "inline";
            document.getElementById("tab-css-button").style.display = "inline";
            document.getElementById("tab-html-content").style.display = "block";
        }
        function expandOrCollapseTestResults(div) {
            if (div.style.display == "none")
                div.style.display = "block";
            else
                div.style.display = "none";
        }
    </script>
</body>

</html>